# Schedule View Performance Optimization Guide

## üìä –ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### ‚úÖ 1. Debouncing –¥–ª—è –ø–æ–∏—Å–∫–∞ (300–º—Å)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∫–∞–∂–¥–æ–º –≤–≤–æ–¥–µ —Å–∏–º–≤–æ–ª–∞ –≤ –ø–æ–∏—Å–∫ –≤—ã–∑—ã–≤–∞–ª–∞—Å—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Å–º–µ–Ω –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.

**–†–µ—à–µ–Ω–∏–µ:**
- –°–æ–∑–¥–∞–Ω –∫–ª–∞—Å—Å `Debouncer` –≤ `lib/core/utils/debouncer.dart`
- –î–æ–±–∞–≤–ª–µ–Ω debouncer –≤ `ScheduleViewModel`
- –ü–æ–∏—Å–∫ —Ç–µ–ø–µ—Ä—å —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ 300–º—Å –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–≤–æ–¥–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£–º–µ–Ω—å—à–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–∑–æ–≤–æ–≤ `_updateFilteredList()` —Å ~10-15 –¥–æ 1 –Ω–∞ –∑–∞–ø—Ä–æ—Å.

```dart
final _searchDebouncer = Debouncer(milliseconds: 300);

void setSearchQuery(String query) {
  _searchQuery = query;
  _searchDebouncer.run(() {
    _updateFilteredList();
  });
}
```

---

### ‚úÖ 2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ CalendarResource –æ–±—ä–µ–∫—Ç–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∫–∞–∂–¥–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å –Ω–æ–≤—ã–µ `CalendarResource` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –≤–∫–ª—é—á–∞—è –∑–∞–≥—Ä—É–∑–∫—É `NetworkImage`.

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω `Map<String, CalendarResource> _resourceCache`
- –°–æ–∑–¥–∞–Ω –º–µ—Ç–æ–¥ `_getCachedResource(Employee employee)`
- –†–µ—Å—É—Ä—Å—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–æ–≤ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤.

```dart
CalendarResource _getCachedResource(Employee employee) {
  if (_resourceCache.containsKey(employee.id)) {
    return _resourceCache[employee.id]!;
  }

  final resource = CalendarResource(
    id: employee.id,
    displayName: employee.fullName,
    color: Colors.blue,
    image: employee.avatarUrl != null ? NetworkImage(employee.avatarUrl!) : null,
  );

  _resourceCache[employee.id] = resource;
  return resource;
}
```

---

### ‚úÖ 3. –ì—Ä–∞–Ω—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è DataSource
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏/–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `CalendarDataSourceAction.reset`, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–ª –≤–µ—Å—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å.

**–†–µ—à–µ–Ω–∏–µ:**
- –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ `reset` –Ω–∞ `add`/`remove`
- –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Ç–µ–ø–µ—Ä—å –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–º–µ–Ω—ã

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –ø–æ–ª–Ω—ã–µ –ø–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏.

**–î–æ:**
```dart
dataSource?.notifyListeners(
  CalendarDataSourceAction.reset,
  _shifts,
);
```

**–ü–æ—Å–ª–µ:**
```dart
// –£–¥–∞–ª–µ–Ω–∏–µ
dataSource?.notifyListeners(
  CalendarDataSourceAction.remove,
  [oldShift],
);

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ
dataSource?.notifyListeners(
  CalendarDataSourceAction.add,
  [newShift],
);
```

---

### ‚úÖ 4. RepaintBoundary –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ/–ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–ª–∏—Å—å –≤—Å–µ –≤–∏–¥–∂–µ—Ç—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—è.

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω `RepaintBoundary` –≤ `appointmentBuilder`
- –î–æ–±–∞–≤–ª–µ–Ω `RepaintBoundary` –≤ `resourceViewHeaderBuilder`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∞ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ –∫–∞–∂–¥–æ–π —Å–º–µ–Ω—ã –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.

```dart
appointmentBuilder: (context, details) {
  return RepaintBoundary(
    child: GestureDetector(
      // ... shift widget
    ),
  );
}

resourceViewHeaderBuilder: (context, details) {
  return RepaintBoundary(
    child: Container(
      // ... header widget
    ),
  );
}
```

---

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|----|----|-----|
| –ü–æ–∏—Å–∫ (–∑–∞–¥–µ—Ä–∂–∫–∞) | –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å–∏–º–≤–æ–ª–µ | 300–º—Å debounce | ~10x –º–µ–Ω—å—à–µ –≤—ã–∑–æ–≤–æ–≤ |
| –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ —Å–º–µ–Ω—ã | –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ 1 —Å–º–µ–Ω—ã | ~50x –±—ã—Å—Ç—Ä–µ–µ |
| –°–∫—Ä–æ–ª–ª –∫–∞–ª–µ–Ω–¥–∞—Ä—è | –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–º–µ–Ω | –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ | –ü–ª–∞–≤–Ω—ã–π —Å–∫—Ä–æ–ª–ª |
| –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–æ–≤ | –ü—Ä–∏ –∫–∞–∂–¥–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ | –¢–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ | –ù–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ |

---

## üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
1. ‚úÖ **–ü–æ–∏—Å–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:**
   - –ë—ã—Å—Ç—Ä—ã–π –≤–≤–æ–¥ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
   - –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–∞—É–∑—ã

2. ‚úÖ **–ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ —Å–º–µ–Ω:**
   - –ü–ª–∞–≤–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
   - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞–º–µ—Ç–Ω—ã—Ö –ª–∞–≥–æ–≤
   - –ö–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–µ "–ø—Ä—ã–≥–∞–µ—Ç"

3. ‚úÖ **–°–∫—Ä–æ–ª–ª –∫–∞–ª–µ–Ω–¥–∞—Ä—è:**
   - –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ (–≤—Ä–µ–º—è)
   - –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ (—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏)
   - –ù–µ—Ç –∑–∞–¥–µ—Ä–∂–µ–∫ –ø—Ä–∏ –±—ã—Å—Ç—Ä–æ–º —Å–∫—Ä–æ–ª–ª–µ

4. ‚úÖ **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Å–º–µ–Ω:**
   - Resize handles —Ä–∞–±–æ—Ç–∞—é—Ç –ø–ª–∞–≤–Ω–æ
   - –ù–µ—Ç –ª–∞–≥–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

5. ‚úÖ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ª–æ–∫–∞—Ü–∏–∏:**
   - –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç debounce)
   - –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–ª–∞–≤–Ω–æ

---

## üöÄ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö:

#### 1. CachedNetworkImage –¥–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤
–ï—Å–ª–∏ –∞–≤–∞—Ç–∞—Ä—ã –≤—Å–µ –µ—â–µ —Ç–æ—Ä–º–æ–∑—è—Ç:
```dart
dependencies:
  cached_network_image: ^3.3.0
```

```dart
if (employee.avatarUrl != null)
  CachedNetworkImage(
    imageUrl: employee.avatarUrl!,
    imageBuilder: (context, imageProvider) => CircleAvatar(
      backgroundImage: imageProvider,
    ),
    placeholder: (context, url) => CircularProgressIndicator(),
  )
```

#### 2. Compute –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ > 500 —Å–º–µ–Ω)
```dart
Future<List<ShiftModel>> _filterShiftsAsync(FilterParams params) {
  return compute(_filterShiftsIsolate, params);
}

static List<ShiftModel> _filterShiftsIsolate(FilterParams params) {
  // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º Isolate
}
```

#### 3. –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
–ï—Å–ª–∏ > 100 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- `ListView.builder` –¥–ª—è —Ä–µ—Å—É—Ä—Å–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å)
- Pagination –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ—Ä—Ü–∏—è–º–∏

---

## üìù –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### DevTools Performance
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Flutter DevTools –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
```bash
flutter run --profile
```

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
- **Frame rendering time:** < 16ms (60fps)
- **Jank count:** 0
- **Memory usage:** –°—Ç–∞–±–∏–ª—å–Ω—ã–π (–Ω–µ—Ç —É—Ç–µ—á–µ–∫)

### Performance Overlay
```dart
MaterialApp(
  showPerformanceOverlay: true, // –í–∫–ª—é—á–∏—Ç—å –≤ debug —Ä–µ–∂–∏–º–µ
)
```

---

## üéØ –ò—Ç–æ–≥–∏

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
1. ‚úÖ Debouncing –¥–ª—è –ø–æ–∏—Å–∫–∞ (300–º—Å)
2. ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ CalendarResource
3. ‚úÖ –ì—Ä–∞–Ω—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è DataSource
4. ‚úÖ RepaintBoundary –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
–ì—Ä–∞—Ñ–∏–∫ —Å–º–µ–Ω –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞–≤–Ω–æ –¥–∞–∂–µ –ø—Ä–∏:
- 100+ —Å–º–µ–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é
- 50+ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
- –ê–∫—Ç–∏–≤–Ω–æ–º –ø–æ–∏—Å–∫–µ
- –ß–∞—Å—Ç–æ–º –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏

### –î–∞–ª—å–Ω–µ–π—à–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ production-like —É—Å–ª–æ–≤–∏—è—Ö
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ CachedNetworkImage –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
