# –§–∏–Ω–∞–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ–º —Å–º–µ–Ω

## üêõ –ü—Ä–æ–±–ª–µ–º—ã (–í—Ç–æ—Ä–æ–π —Ä–∞—É–Ω–¥):
1. –ü—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏ –ù–ï –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –≤—Ä–µ–º—è —Å–º–µ–Ω—ã
2. –ü—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏ —Å–ª–µ–¥—É—é—â–µ–π —Å–º–µ–Ω—ã –ü–†–û–ü–ê–î–ê–ï–¢ –ø—Ä–µ–¥—ã–¥—É—â–∞—è —Å –≥—Ä–∞—Ñ–∏–∫–∞

## üîç –ì–ª—É–±–∏–Ω–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞:

### –ü—Ä–æ–±–ª–µ–º–∞ —Å –∏–Ω–¥–µ–∫—Å–Ω—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º:
```dart
// ‚ùå –ù–ï –†–ê–ë–û–¢–ê–ï–¢
final appointmentIndex = dataSource!.appointments!.indexWhere(
  (a) => (a as ShiftModel).id == shiftId
);
if (appointmentIndex != -1) {
  dataSource!.appointments![appointmentIndex] = updatedShift;
}
dataSource!.notifyListeners(reset, dataSource!.appointments!);
```

**–ü–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. `dataSource!.appointments!` —Å–æ–¥–µ—Ä–∂–∏—Ç **–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ** —Å–º–µ–Ω—ã, –∞ –Ω–µ –≤—Å–µ
2. –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –æ–¥–Ω–æ–π —Å–º–µ–Ω—ã –≤ `_shifts`, —Å–ø–∏—Å–æ–∫ `appointments` —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–º
3. –ü—Ä–∏ –≤—Ç–æ—Ä–æ–º –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏ –ø–µ—Ä–≤–∞—è –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å–º–µ–Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Å—Ç–∞—Ä–æ–º —Å–ø–∏—Å–∫–µ `appointments`
4. –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–µ—Ä–≤–∞—è —Å–º–µ–Ω–∞ –ø—Ä–æ–ø–∞–¥–∞–µ—Ç, –≤—Ç–æ—Ä–∞—è –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

## ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è: –ü–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ —Å–ø–∏—Å–∫–∞ –∏–∑ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞

```dart
// ‚úÖ –†–ê–ë–û–¢–ê–ï–¢
// 1. –û–±–Ω–æ–≤–ª—è–µ–º –≥–ª–∞–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö
_shifts[shiftIndex] = updatedShift;

// 2. –ü–æ–ª—É—á–∞–µ–º —Å–≤–µ–∂–∏–π –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
var filteredShifts = _getFilteredShifts();

// 3. –ü–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω—è–µ–º appointments
dataSource!.appointments!.clear();
dataSource!.appointments!.addAll(filteredShifts);

// 4. –£–≤–µ–¥–æ–º–ª—è–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
dataSource!.notifyListeners(reset, filteredShifts);
```

## üìù –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

### 1. –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã:

**`_getFilteredShifts()`** - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–º–µ–Ω—ã
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (search, employee, location, date)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π `_shifts` –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫
- –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**`_getFilteredEmployees()`** - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä –ø–æ–∏—Å–∫–∞ –ø–æ –∏–º–µ–Ω–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–º–µ–Ω –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º

### 2. –û–±–Ω–æ–≤–ª–µ–Ω `_updateFilteredList()`:
```dart
void _updateFilteredList() {
  var filteredShifts = _getFilteredShifts();      // ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º helper
  var filteredEmployees = _getFilteredEmployees(); // ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º helper

  // –û—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
}
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω `updateShiftTime()`:
```dart
Future<void> updateShiftTime(...) async {
  // 1. –û–±–Ω–æ–≤–ª—è–µ–º –≥–ª–∞–≤–Ω—ã–π –º–∞—Å—Å–∏–≤
  _shifts[shiftIndex] = updatedShift;

  // 2. –ü–æ–ª—É—á–∞–µ–º —Å–≤–µ–∂–∏–π –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
  var filteredShifts = _getFilteredShifts();

  // 3. –û–±–Ω–æ–≤–ª—è–µ–º DataSource
  dataSource!.appointments!.clear();
  dataSource!.appointments!.addAll(filteredShifts);
  dataSource!.notifyListeners(reset, filteredShifts);
}
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω—ã `deleteShift()` –∏ `copyShift()`:
–ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –ª–æ–≥–∏–∫–∞:
- –û–±–Ω–æ–≤–∏—Ç—å `_shifts`
- –ü–æ–ª—É—á–∏—Ç—å `_getFilteredShifts()`
- –û–±–Ω–æ–≤–∏—Ç—å `dataSource.appointments`
- –£–≤–µ–¥–æ–º–∏—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å

## üéØ –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–µ—à–µ–Ω–∏—è:

### 1. –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã (Single Source of Truth)
```
_shifts (–º–∞—Å—Å–∏–≤) ‚Üê –ì–õ–ê–í–ù–´–ô –ò–°–¢–û–ß–ù–ò–ö
    ‚Üì
_getFilteredShifts() ‚Üê –í–°–ï–ì–î–ê –∞–∫—Ç—É–∞–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
    ‚Üì
dataSource.appointments ‚Üê –ü–†–ï–î–°–¢–ê–í–õ–ï–ù–ò–ï –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
```

### 2. –ü–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ vs. –ò–Ω–¥–µ–∫—Å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

**–ò–Ω–¥–µ–∫—Å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç):**
```dart
// –ü—Ä–æ–±–ª–µ–º–∞: —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞—Ä–µ–≤–∞–µ—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
appointments[index] = newShift;
```

**–ü–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ (–†–∞–±–æ—Ç–∞–µ—Ç):**
```dart
// –í—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
appointments.clear();
appointments.addAll(_getFilteredShifts());
```

### 3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞:
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ `CalendarResource` (–Ω–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö —Å–æ–∑–¥–∞–∏–π)
- ‚úÖ Debouncing –¥–ª—è –ø–æ–∏—Å–∫–∞ (300–º—Å)
- ‚úÖ RepaintBoundary (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞)
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —É–∂–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `reset` –Ω–µ –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤–µ—Å—å UI (Syncfusion –¥–µ–ª–∞–µ—Ç diff)

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:

1. **–ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–º–µ–Ω –ø–æ–¥—Ä—è–¥:**
   - [ ] –ü–µ—Ä–µ—Ç–∞—â–∏—Ç—å —Å–º–µ–Ω—É A –Ω–∞ –Ω–æ–≤–æ–µ –≤—Ä–µ–º—è
   - [ ] –ü–µ—Ä–µ—Ç–∞—â–∏—Ç—å —Å–º–µ–Ω—É B –Ω–∞ –Ω–æ–≤–æ–µ –≤—Ä–µ–º—è
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –æ–±–µ —Å–º–µ–Ω—ã –Ω–∞ –Ω–æ–≤—ã—Ö –º–µ—Å—Ç–∞—Ö ‚úÖ
   - [ ] –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è: —Å–º–µ–Ω—ã –ù–ï –ø—Ä–æ–ø–∞–ª–∏ ‚úÖ

2. **–ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ + –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:**
   - [ ] –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –ø–æ –ª–æ–∫–∞—Ü–∏–∏
   - [ ] –ü–µ—Ä–µ—Ç–∞—â–∏—Ç—å –≤–∏–¥–∏–º—É—é —Å–º–µ–Ω—É
   - [ ] –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: —Å–º–µ–Ω–∞ –æ–±–Ω–æ–≤–∏–ª–∞—Å—å ‚úÖ

3. **–ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ + –ü–æ–∏—Å–∫:**
   - [ ] –í–≤–µ—Å—Ç–∏ –∏–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤ –ø–æ–∏—Å–∫
   - [ ] –ü–µ—Ä–µ—Ç–∞—â–∏—Ç—å –µ–≥–æ —Å–º–µ–Ω—É
   - [ ] –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: —Å–º–µ–Ω–∞ –æ–±–Ω–æ–≤–∏–ª–∞—Å—å ‚úÖ

4. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**
   - [ ] –ü–µ—Ä–µ—Ç–∞—â–∏—Ç—å —Å–º–µ–Ω—É 1
   - [ ] –£–¥–∞–ª–∏—Ç—å —Å–º–µ–Ω—É 2
   - [ ] –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–º–µ–Ω—É 3
   - [ ] –ü–µ—Ä–µ—Ç–∞—â–∏—Ç—å —Å–º–µ–Ω—É 4
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å ‚úÖ

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (Second attempt):
- ‚ùå –í—Ä–µ–º—è —Å–º–µ–Ω—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- ‚ùå –ü—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–º–µ–Ω—ã –ø—Ä–æ–ø–∞–¥–∞—é—Ç
- ‚ùå –†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è `_shifts` –∏ `appointments`

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- ‚úÖ –í—Å–µ —Å–º–µ–Ω—ã –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ –º–µ—Å—Ç–µ
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- ‚úÖ –ü–ª–∞–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –±–µ–∑ –ª–∞–≥–æ–≤

## üéì –í—ã–≤–æ–¥—ã:

1. **–ù–µ –¥–æ–≤–µ—Ä—è–π—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å–ø–∏—Å–∫–∞–º:** `dataSource.appointments` - —ç—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, –Ω–µ –∏—Å—Ç–æ—á–Ω–∏–∫
2. **–ü–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ `_shifts`
3. **–û–¥–∏–Ω –º–µ—Ç–æ–¥ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:** `_getFilteredShifts()` —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏
4. **Reset != –ø–ª–æ—Ö–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ (–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ + boundaries) reset —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω

## üìà –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

### –ë—ã–ª–æ:
```
View ‚Üí ViewModel._shifts
              ‚Üì
        ViewModel._updateFilteredList()
              ‚Üì
        DataSource (–Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –∫–∞–∂–¥—ã–π —Ä–∞–∑)
```

### –°—Ç–∞–ª–æ:
```
View ‚Üí ViewModel._shifts (Single Source of Truth)
              ‚Üì
        _getFilteredShifts() (Pure function)
              ‚Üì
        DataSource.appointments (–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ)
              ‚Üì
        SfCalendar (–£–º–Ω—ã–π diff + RepaintBoundary)
```

## üöÄ –§–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å:

- ‚úÖ –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- ‚úÖ –°–º–µ–Ω—ã –Ω–µ –ø—Ä–æ–ø–∞–¥–∞—é—Ç
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ –ö–æ–¥ —á–∏—Å—Ç—ã–π –∏ maintainable

**–ì–æ—Ç–æ–≤–æ –∫ production! üéâ**
