# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞: Shift Manager CRM

## 1. –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
**Shift Manager CRM** ‚Äî —ç—Ç–æ –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–µ Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—á–∏—Ö —Å–º–µ–Ω. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º —Å–æ—Å—Ç–∞–≤–ª—è—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏, –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏, —É–ø—Ä–∞–≤–ª—è—Ç—å –±–∞–∑–æ–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
*   **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É (Mock-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è).
*   **–î–∞—à–±–æ—Ä–¥:** –°–≤–æ–¥–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–Ω—è—Ö —Ä–æ–∂–¥–µ–Ω–∏—è –∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏.
*   **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–º:** –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–º–µ–Ω (–¥–µ–Ω—å/–Ω–µ–¥–µ–ª—è/–º–µ—Å—è—Ü), Drag & Drop —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–æ–∑–¥–∞–Ω–∏–µ —Å–º–µ–Ω.
*   **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (–Ω–∞–ª–æ–∂–µ–Ω–∏—è, –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏, –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç–¥—ã—Ö–∞).
*   **–ë–∞–∑–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:** –¢–∞–±–ª–∏—á–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –ø–æ–∏—Å–∫, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π.

---

## 2. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

*   **–§—Ä–µ–π–º–≤–æ—Ä–∫:** Flutter (Dart SDK ^3.8.0).
*   **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** MVVM (Model-View-ViewModel) + Clean Architecture.
*   **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º:** Native `ValueNotifier` / `ChangeNotifier`.
*   **–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (DI):** –ö–∞—Å—Ç–æ–º–Ω—ã–π Service Locator (`ModuleLocator`).
*   **–ù–∞–≤–∏–≥–∞—Ü–∏—è:** –ö–∞—Å—Ç–æ–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Navigator 2.0 (Router API).
*   **UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
    *   `syncfusion_flutter_calendar` ‚Äî –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞.
    *   `syncfusion_flutter_datagrid` ‚Äî –¥–ª—è —Ç–∞–±–ª–∏—Ü —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.
    *   Material 3 Design.
*   **–°–µ—Ç—å:** –ü–∞–∫–µ—Ç `http` —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–µ–π –∏ –∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä–∞–º–∏.

---

## 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ü—Ä–æ–µ–∫—Ç —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏. –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –æ–¥–Ω–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π.

```mermaid
classDiagram
    class View {
        +build()
        +listenToViewModel()
    }
    class ViewModel {
        +State<AsyncValue>
        +loadData()
        +handleUserAction()
    }
    class Repository {
        +getData()
        +saveData()
    }
    class ApiService {
        +fetch()
        +post()
    }
    class Model {
        +DataFields
        +fromJson()
    }

    View --> ViewModel : User Actions
    ViewModel ..> View : Notifies Changes
    ViewModel --> Repository : Requests Data
    Repository --> ApiService : API Calls
    ApiService --> Model : Returns DTO
    Repository --> Model : Returns Domain Model
```
[Edit in Mermaid Playground](https://www.mermaidchart.com/play#pako:eJx1U8FuAiEQ_RXCqU3UmPa2t63apE1sG7WevEyXUUnZxcJgY4z_XhC1KMplYebNe8NbZssrLZAXvFJgbV_CwkA9a5hf-wibSvxl2xgJa-a63YenLyeVuLu_DCtpCZuJDkVDz6uOkN0l5T6b844JCMP2sVfaTVNNQbl4HmRaGkQfCPIultAIhZ8WTVmR1M3VJka40laSNpu8iwXSdWYLa0wzZ4zlSo7RrGWFOeMcqVrmfL4Fusp1w56g_SxRCZsJGF2_2rO7xs3-_7Xb0cPE-oIFg1h0yP5jY7bTSQo89k2TnEu0rOfNXWCGPwkkthb-8OPQkmWh71iS5E81iXEFKz9eWA-UOkgkuRP-eIERkjONZ5-83ybPwLoG2cQwb_EajT8LXmw5LbEOkyDAfPNdi4MjPfZvkBdkHLa4Wwn_OA8jwos5KOujKILg8DBE4bP7A6oXBIs=)



### –°–ª–æ–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
1.  **Presentation Layer (UI):**
    *   **Views:** –≠–∫—Ä–∞–Ω—ã (`ScheduleView`, `DashboardView`). –ü–∞—Å—Å–∏–≤–Ω—ã, –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ VM.
    *   **Widgets:** –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (`ConflictWarningBox`, `SummaryBar`).
2.  **Logic Layer (ViewModel):**
    *   –£–ø—Ä–∞–≤–ª—è—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —ç–∫—Ä–∞–Ω–∞.
    *   –ò—Å–ø–æ–ª—å–∑—É—é—Ç `AsyncValue` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∑–∞–≥—Ä—É–∑–∫–∏/–æ—à–∏–±–∫–∏/–¥–∞–Ω–Ω—ã—Ö.
    *   –ü—Ä–∏–º–µ—Ä: `ScheduleViewModel`, `EmployeeSyncfusionViewModel`.
3.  **Domain Layer (Repositories):**
    *   –ò–∑–æ–ª–∏—Ä—É—é—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö.
    *   –ü—Ä–∏–º–µ—Ä: `ShiftRepository`, `EmployeeRepository`.
4.  **Data Layer (Services & Models):**
    *   `ApiService`: –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ç—å—é.
    *   `MockApiService`: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

---

## 4. –ö–ª—é—á–µ–≤—ã–µ –º–æ–¥—É–ª–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 4.1. –ú–æ–¥—É–ª—å –†–∞—Å–ø–∏—Å–∞–Ω–∏—è (`lib/schedule`)
–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

*   **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `SfCalendar`. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–∂–∏–º—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–∞: –î–µ–Ω—å, –ù–µ–¥–µ–ª—è (Timeline), –ú–µ—Å—è—Ü.
*   **Drag & Drop:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ —Å–º–µ–Ω –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∏–ª–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –¥—Ä—É–≥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.
*   **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:**
    *   –ü–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É, –¥–æ–ª–∂–Ω–æ—Å—Ç–∏, —Ñ–∏–ª–∏–∞–ª—É.
    *   –ü—Ä–µ—Å–µ—Ç—ã: "–ú–æ–∏ —Å–º–µ–Ω—ã", "–° –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞–º–∏", "–ù–µ–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ".
*   **–í–∞–ª–∏–¥–∞—Ü–∏—è (Conflict Checker):**
    –ö–ª–∞—Å—Å `ShiftConflictChecker` (`lib/schedule/utils/shift_conflict_checker.dart`) –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
    *   `timeOverlap`: –ù–∞–ª–æ–∂–µ–Ω–∏–µ —Å–º–µ–Ω –ø–æ –≤—Ä–µ–º–µ–Ω–∏.
    *   `insufficientRest`: –û—Ç–¥—ã—Ö –º–µ–∂–¥—É —Å–º–µ–Ω–∞–º–∏ –º–µ–Ω–µ–µ 8 —á–∞—Å–æ–≤.
    *   `tooManyShiftsPerDay`: –ë–æ–ª–µ–µ 2 —Å–º–µ–Ω –≤ –¥–µ–Ω—å.
    *   `locationConflict`: –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
    *   –†–∞–∑–¥–µ–ª—è–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –Ω–∞ **Hard Errors** (–±–ª–æ–∫–∏—Ä—É—é—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ) –∏ **Warnings** (—Ç—Ä–µ–±—É—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è).

### 4.2. –ú–æ–¥—É–ª—å –°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (`lib/employees_syncfusion`)
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª–∞.

*   **–¢–∞–±–ª–∏—Ü–∞:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `SfDataGrid` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏: –ò–º—è, –î–æ–ª–∂–Ω–æ—Å—Ç—å, –§–∏–ª–∏–∞–ª, –°—Ç–∞—Ç—É—Å, –û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —á–∞—Å–æ–≤.
*   **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:** `EmployeeDataSource` –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –º–æ–¥–µ–ª–∏ –¥–ª—è –≥—Ä–∏–¥–∞.
*   **–§—É–Ω–∫—Ü–∏–∏:** –ü–æ–∏—Å–∫, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, —É–¥–∞–ª–µ–Ω–∏–µ, —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.

### 4.3. –ú–æ–¥—É–ª—å –î–∞—à–±–æ—Ä–¥–∞ (`lib/dashboard`)
–°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π.

*   **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:** `DashboardStats` (–≤—Å–µ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Å–º–µ–Ω—ã —Å–µ–≥–æ–¥–Ω—è, —á–∞—Å—ã –∑–∞ –Ω–µ–¥–µ–ª—é).
*   **–ê–ª–µ—Ä—Ç—ã:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–ø—Ä–æ—Å–∞—Ö –Ω–∞ –≤—ã—Ö–æ–¥–Ω–æ–π –∏–ª–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –Ω–∞ –ø—è—Ç–Ω–∏—Ü—É.
*   **–î–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è:** –°–ø–∏—Å–æ–∫ –±–ª–∏–∂–∞–π—à–∏—Ö –∏–º–µ–Ω–∏–Ω–Ω–∏–∫–æ–≤.

### 4.4. –ù–∞–≤–∏–≥–∞—Ü–∏—è (`lib/core/utils/navigation`)
–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –Ω–∞ –±–∞–∑–µ **Navigator 2.0**, –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –ø–∞–∫–µ—Ç–æ–≤ (–∫–∞–∫ go_router).

*   **`RouterService`:** ViewModel –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏. –•—Ä–∞–Ω–∏—Ç —Å—Ç–µ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü (`_navigationStack`). –ú–µ—Ç–æ–¥—ã: `goTo`, `replace`, `back`.
*   **`AppRouterDelegate`:** –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å—Ç–µ–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü Flutter –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ `RouterService`.
*   **`RouteConfig`:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ä—Ç—É –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (`requiresAuth`).

---

## 5. –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ (Data Layer)

### 5.1. Mock API Service
–í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `MockApiService` (`lib/data/services/mock_api_service.dart`), –∫–æ—Ç–æ—Ä—ã–π —ç–º—É–ª–∏—Ä—É–µ—Ç –±—ç–∫–µ–Ω–¥.

*   **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:** –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç ~50 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ –∏ –∞–≤–∞—Ç–∞—Ä–∞–º–∏ (—á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å ui-avatars.com).
*   **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–º–µ–Ω:** –°–æ–∑–¥–∞–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü, —É—á–∏—Ç—ã–≤–∞—è –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞ –Ω–µ–ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è.
*   **–ó–∞–¥–µ—Ä–∂–∫–∞:** –ò–º–∏—Ç–∏—Ä—É–µ—Ç —Å–µ—Ç–µ–≤—É—é –∑–∞–¥–µ—Ä–∂–∫—É (`Future.delayed`) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ UI –ª–æ–∞–¥–µ—Ä–æ–≤.

### 5.2. Dependency Injection
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞—Å—Ç–æ–º–Ω—ã–π Service Locator –≤ —Ñ–∞–π–ª–µ `lib/core/utils/locator.dart`.
–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ `lib/config/locator_config.dart`:

```dart
final modules = [
  Module<RouterService>(builder: () => RouterService(...), lazy: false),
  Module<AuthRepository>(builder: () => AuthRepository(...), lazy: true),
  // ... –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã
];
```

---

## 6. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
*   Flutter SDK: `^3.8.0`
*   Dart SDK: –°–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å Flutter 3.8+

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞
1.  –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.
2.  –í—ã–ø–æ–ª–Ω–∏—Ç—å `flutter pub get`.
3.  –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç `flutter run`.

### –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞ (Mock)
*   **Email:** `admin@example.com`
*   **–ü–∞—Ä–æ–ª—å:** `password123`

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫
```text
lib/
‚îú‚îÄ‚îÄ auth/           # –≠–∫—Ä–∞–Ω –ª–æ–≥–∏–Ω–∞ –∏ VM
‚îú‚îÄ‚îÄ config/         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–æ—É—Ç–∏–Ω–≥–∞ –∏ DI
‚îú‚îÄ‚îÄ core/           # –ë–∞–∑–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã (UI –∫–∏—Ç, –Ω–∞–≤–∏–≥–∞—Ü–∏—è, DI, –æ—à–∏–±–∫–∏)
‚îú‚îÄ‚îÄ dashboard/      # –≠–∫—Ä–∞–Ω –¥–∞—à–±–æ—Ä–¥–∞
‚îú‚îÄ‚îÄ data/           # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, –º–æ–¥–µ–ª–∏, API —Å–µ—Ä–≤–∏—Å—ã
‚îú‚îÄ‚îÄ employees_syncfusion/ # –≠–∫—Ä–∞–Ω —Å–ø–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
‚îú‚îÄ‚îÄ schedule/       # –≠–∫—Ä–∞–Ω –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∏ –ª–æ–≥–∏–∫–∞ —Å–º–µ–Ω
‚îú‚îÄ‚îÄ startup/        # –õ–æ–≥–∏–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ main.dart       # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

---

## 7. –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ TODO
1.  **–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:** –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (`MockApiService`). –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ—Ä—è—é—Ç—Å—è.
2.  **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è:** –ü–æ–¥–∫–ª—é—á–µ–Ω –ø–∞–∫–µ—Ç `intl`, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Ä—É—Å—Å–∫–∞—è –ª–æ–∫–∞–ª—å, –Ω–æ —Å—Ç—Ä–æ–∫–∏ –≤ –∫–æ–¥–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.
3.  **–¢–µ—Å—Ç—ã:** –í —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –µ—Å—Ç—å –ø–∞–ø–∫–∞ `test`, –Ω–æ –≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–æ–∫—Ä—ã—Ç–∏–µ Unit-—Ç–µ—Å—Ç–∞–º–∏ `ShiftConflictChecker`.














# API Specification for Shift Manager CRM

## 1. –û–±—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

*   **Base URL:** `https://api.shiftmanager.com/v1` (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏).
*   **–§–æ—Ä–º–∞—Ç –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏:** JSON.
*   **–ö–æ–¥–∏—Ä–æ–≤–∫–∞:** UTF-8.
*   **–§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏:** ISO 8601 (`YYYY-MM-DDTHH:mm:ss.sss`), –Ω–∞–ø—Ä–∏–º–µ—Ä `2023-10-25T09:00:00.000`.
*   **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** HTTP –∫–æ–¥—ã (200 OK, 400 Bad Request, 401 Unauthorized, 404 Not Found, 500 Internal Server Error).

## 2. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–∂–∏–¥–∞–µ—Ç, —á—Ç–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ –±—É–¥–µ—Ç –ø–æ–ª—É—á–µ–Ω –æ–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –í —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —è–≤–Ω–æ –≤ –º–µ—Ç–æ–¥–∞—Ö, –Ω–æ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Authorization: Bearer <token>` –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä.*

### Login
**POST** `/auth/login`

**Request Body:**
```json
{
  "username": "admin",
  "password": "password123"
}
```

**Response Body (200 OK):**
```json
{
  "user": {
    "id": "user_1",
    "username": "admin",
    "role": "administrator" // —Å–º. —Ä–∞–∑–¥–µ–ª Enums
  },
  "token": "eyJhbGciOiJIUz..." // –¢–æ–∫–µ–Ω –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
}
```

### Logout
**POST** `/auth/logout`
*–ó–∞–≥–æ–ª–æ–≤–∫–∏: Authorization required*

---

## 3. –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ (Employees)

### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
**GET** `/employees`

**Response Body:**
```json
[
  {
    "id": "emp_1",
    "first_name": "–ò–≤–∞–Ω",
    "last_name": "–ò–≤–∞–Ω–æ–≤",
    "position": "–ö–∞—Å—Å–∏—Ä",
    "branch": "–¢–¶ –ú–µ–≥–∞",
    "status": "active",
    "hire_date": "2022-01-15T00:00:00.000",
    "avatar_url": "https://...",
    "email": "ivan@example.com",
    "phone": "+7 (900) 123-45-67",
    "birthday": "1990-05-20T00:00:00.000",
    "desired_days_off": [
      {
        "date": "2023-11-01T00:00:00.000",
        "comment": "–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è"
      }
    ]
  }
]
```

### CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
*   **GET** `/employees/{id}` ‚Äî –ü–æ–ª—É—á–∏—Ç—å –æ–¥–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.
*   **POST** `/employees` ‚Äî –°–æ–∑–¥–∞—Ç—å (Body –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω JSON –≤—ã—à–µ, –±–µ–∑ `id`).
*   **PUT** `/employees/{id}` ‚Äî –û–±–Ω–æ–≤–∏—Ç—å.
*   **DELETE** `/employees/{id}` ‚Äî –£–¥–∞–ª–∏—Ç—å (–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å).

---

## 4. –°–º–µ–Ω—ã (Shifts)

### –ü–æ–ª—É—á–∏—Ç—å —Å–º–µ–Ω—ã (—Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π)
**GET** `/shifts`

**Query Parameters:**
*   `start`: ISO Date (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚Äî –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞.
*   `end`: ISO Date (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚Äî –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞.
*   `employee_id`: String (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É.

**Response Body:**
```json
[
  {
    "id": "shift_101",
    "employee_id": "emp_1",
    "location": "–¢–¶ –ú–µ–≥–∞",
    "start_time": "2023-10-25T09:00:00.000",
    "end_time": "2023-10-25T18:00:00.000",
    "status": "confirmed",
    "notes": "–í–∞–∂–Ω–∞—è —Å–º–µ–Ω–∞",
    "is_night_shift": false,
    "employee_preferences": "–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é —É—Ç—Ä–æ",
    "role_title": "–ö–∞—Å—Å–∏—Ä",
    "hourly_rate": 400.0
  }
]
```

### CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
*   **GET** `/shifts/{id}`
*   **POST** `/shifts`
*   **PUT** `/shifts/{id}`
*   **DELETE** `/shifts/{id}`

---

## 5. –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (Dictionaries)

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–ø–∏—Å–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–∏—Ö —Å–ø–∏—Å–∫–æ–≤.

### –§–∏–ª–∏–∞–ª—ã
**GET** `/dictionaries/branches` (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π endpoint, –≤ –∫–æ–¥–µ –∞–±—Å—Ç—Ä–∞–≥–∏—Ä–æ–≤–∞–Ω–æ)
**Response:** `["–¢–¶ –ú–µ–≥–∞", "–¶–µ–Ω—Ç—Ä", "–ê—ç—Ä–æ–ø–æ—Ä—Ç"]`

### –†–æ–ª–∏/–î–æ–ª–∂–Ω–æ—Å—Ç–∏
**GET** `/dictionaries/roles`
**Response:** `["–£–±–æ—Ä—â–∏—Ü–∞", "–ö–∞—Å—Å–∏—Ä", "–ü–æ–≤–∞—Ä", "–ú–µ–Ω–µ–¥–∂–µ—Ä"]`

---

## 6. –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∑–Ω–∞—á–µ–Ω–∏–π (Enums & Constants)

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—Ü–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è, –∏–∫–æ–Ω–∫–∏) –±—ç–∫–µ–Ω–¥ –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (case-sensitive):

### –°—Ç–∞—Ç—É—Å—ã —Å–º–µ–Ω—ã (`status`)
| –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –¶–≤–µ—Ç –≤ UI |
| :--- | :--- | :--- |
| `pending` | –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è | üü° Amber |
| `confirmed` | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ | üîµ Blue |
| `cancelled` | –û—Ç–º–µ–Ω–µ–Ω–∞ | ‚ö™ Grey |

### –°—Ç–∞—Ç—É—Å—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (`status`)
| –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| `active` | –†–∞–±–æ—Ç–∞–µ—Ç |
| `vacation` | –í –æ—Ç–ø—É—Å–∫–µ |
| `sick_leave` | –ù–∞ –±–æ–ª—å–Ω–∏—á–Ω–æ–º |

### –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (`role`)
| –ó–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ |
| :--- | :--- |
| `administrator` | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø |
| `manager` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–º–µ–Ω–∞–º–∏ |
| `employee` | –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä |

---

## 7. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ Flutter

–ß—Ç–æ–±—ã –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å Mock –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π API, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–≤–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1.  **–û–±–Ω–æ–≤–∏—Ç—å Base URL:**
    –í —Ñ–∞–π–ª–µ `lib/core/constants/api_endpoints.dart`:
    ```dart
    static const String baseUrl = 'https://your-production-api.com'; // –ò–∑–º–µ–Ω–∏—Ç—å –∑–¥–µ—Å—å
    ```

2.  **–ó–∞–º–µ–Ω–∏—Ç—å Mock-—Å–µ—Ä–≤–∏—Å –Ω–∞ –†–µ–∞–ª—å–Ω—ã–π:**
    –í —Ñ–∞–π–ª–µ `lib/config/locator_config.dart` –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é `ApiService`.

    *–ë—ã–ª–æ:*
    ```dart
    Module<ApiService>(
      builder: () => MockApiService(),
      lazy: false,
    ),
    ```

    *–°—Ç–∞–Ω–µ—Ç (–Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `lib/data/services/http_api_service.dart`):*
    ```dart
    Module<ApiService>(
      builder: () => HttpApiService(
        http: locator<HttpAbstraction>(), // –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π HTTP –∫–ª–∏–µ–Ω—Ç
      ),
      lazy: false,
    ),
    ```

### –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ `HttpApiService` (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏)

```dart
class HttpApiService implements ApiService {
  final HttpAbstraction _http;

  HttpApiService({required HttpAbstraction http}) : _http = http;

  @override
  Future<List<Employee>> getEmployees() async {
    final response = await _http.get(Uri.parse(ApiEndpoints.employees));
    if (response.statusCode == 200) {
      final List data = json.decode(response.body);
      return data.map((e) => Employee.fromJson(e)).toList();
    }
    throw Exception('Failed to load employees');
  }
  
  // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ ApiService...
}
